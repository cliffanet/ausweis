#!/usr/bin/perl
package main;

our $VERSION = '0.02';
our $version = $VERSION =~ /^(\d*\.\d)(\d*)$/ ? sprintf("%0.1f.%d", $1, $2 || 0) : $VERSION;

my $config = "$::pathRoot/conf/main.conf";
our $logPath            = "$::pathRoot/logs";
our $pidPath            = "/var/run/nnm";

##########################################################################################

our %disp = (
    CommandList         => 'command/list',
    CommandShow         => 'command/%d/%s',
    CommandShowMy       => 'command/my/%s',
    
    AusweisList         => 'ausweis/list',
    AusweisShow         => 'ausweis/%d/%s',
    AusweisImage        => 'ausweis/%d/img/%s',
);


our $dirFiles           = '/files/www/ausweis/files';
our $dirPhoto           = '/files/www/ausweis/html/photo';
our $urlPhoto           = '/photo';

our $convertFileBlok    = '/files/ftp/cliff/ausweis/blok.txt';
our $convertFileCommand = '/files/ftp/cliff/ausweis/command.txt';
our $convertFileAusweis = '/files/ftp/cliff/ausweis/ausweis.txt';
our $convertDirPhoto    = '/files/ftp/cliff/ausweis',

our %imgSize = (
    site        => { width      => 300 },
    aus         => { width      => 150 },
);

our %print_img = (
    width       => 300,
    height      => 480,
    density     => 150,
    bgcolor     => 'white',
    
    front       => [
        # Рамка для отреза
        area => { points => "0,0 299,479", stroke => 'black' },
        
        # Фото
        photo => { x => 9, y => 39, width => 134, height => 145, align => 'left' },
        
        # Лого команды, если такое есть
        logo => { x => 159, y => 39, width => 134, height => 145, align => 'right' },
        
        # Рамка текста
        area => { points => "9,197 290,400", stroke => 'black', strokewidth => 5 },
        
        # Ник
        text => { text => '%nick%', 
                    pointsize=>10, font=>"Tahoma", weight=>5, fill=>'red', 
                    x=>150, y=>220, align=>'center' },
        # ФИО        
        text => { text => '%fio%', 
                    pointsize=>6, font=>"Tahoma", weight=>3,
                    x=>150, y=>240, align=>'center' },
        
        # команда
        text => { text => '%command.name%', 
                    pointsize=>6, font=>"Arial Black", weight=>30,
                    x=>150, y=>260, align=>'center' },
        
        # Аллергия
        text => { text => 'Аллергия: %allerg%', 
                    pointsize=>6, font=>"Tahoma", weight=>3,
                    x=>150, y=>300, align=>'center' },
        # Непереносимость
        text => { text => 'Непереносимость: %neperenos%', 
                    pointsize=>6, font=>"Tahoma", weight=>3,
                    x=>150, y=>340, align=>'center' },
                    
        # Полис
        text => { text => '%polis%', 
                    pointsize=>8, font=>"Tahoma", weight=>3,
                    x=>150, y=>390, align=>'center' },
                
        # Блок
        text => { text => 'Блок "%blok.name%"', if => '$rec->{blok}->{id}',
                    pointsize=>6, font=>"Tahoma", weight=>3,
                    x=>150, y=>440, align=>'center' },
    ],
    
    rear        => [
        # Рамка для отреза
        area => { points => "0,0 299,479", stroke => 'black' },
        
        # Текст 1
        text => { text => "Используя данную карту, я подтверждаю
согласие с Правилами, по которым
проводится Игра.
Я информирован о том, что во время Игры
могут возникнуть ситуации, опасные для моей 
жизни т здоровья.
Используя данную карту, я полностью согласен
с тем, что организаторы ответственности, в 
случае приченения вреда моему здоровью,
не несут.", 
                    pointsize=>6, font=>"Tahoma", weight=>5, 
                    x=>9, y=>50, align=>'left' },
        
        # Рамка текста 2
        area => { points => "9,180 290,290", stroke => 'black', strokewidth => 5 },
        
        # Текст 2
        text => { text => "Использование данной Карты
возможно только владельцем. В
случае использования Карты 3-м
лицом, она немедленно изымается и
уничтожается. Восстановление Карты
в этом случае невозможно.", 
                    pointsize=>7, font=>"Tahoma", weight=>5, 
                    x=>20, y=>200, align=>'left' },
        
        barcode => { x => 9, y => 340, width => 280, height => 90 },
                    
        # Код
        text => { text => '%numid%',
                    pointsize=>8, font=>"Tahoma", weight=>3,
                    x=>150, y=>445, align=>'center' },
    ],
    
);

require $config;


#==========================================================
#================================================== End ===
#==========================================================
1;
